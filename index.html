<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Google Drive API Image Picker</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
      var CLIENT_ID = '173678122015-90fc4v9mhoch9knqndel2v6ja6gp5ck2.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyBHe7vaLrnkAm1J8nBwDTSQyzK214OpWfI';
      var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];
      var SCOPES = 'https://www.googleapis.com/auth/drive.readonly';

      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
          console.log('Google Drive API client initialized');
        }, function (error) {
          console.error('Error initializing Google Drive API client', error);
        });
      }

      function openPicker() {
        gapi.auth2.getAuthInstance().signIn().then(function () {
          var picker = new google.picker.PickerBuilder()
            .addView(google.picker.ViewId.PHOTOS)
            .setOAuthToken(gapi.auth.getToken().access_token)
            .setDeveloperKey(API_KEY)
            .setCallback(pickerCallback)
            .build();
          picker.setVisible(true);
        });
      }

      function pickerCallback(data) {
        if (data.action == google.picker.Action.PICKED) {
          var file = data.docs[0];
          var fileId = file.id;
          var request = gapi.client.drive.files.get({
            'fileId': fileId,
            'alt': 'media'
          });
          request.execute(function (response) {
            console.log('Selected image:', response);
            // Do something with the selected image
          });
        }
      }
    </script>
  </head>
  <body onload="handleClientLoad()">
    <h1>Google Drive API Image Picker</h1>
    <button onclick="openPicker()">Select Image</button>
  </body>
</html>
